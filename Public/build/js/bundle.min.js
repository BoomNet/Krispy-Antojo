let sidebar=document.querySelector(".sidebar"),closeBtn=document.querySelector("#btn");const Logout=document.querySelector("#logout"),BtnUpdateSpending=document.querySelectorAll(".btn-gasto"),Modal=document.querySelector("#modal-gasto"),DeleteSpending=document.querySelectorAll("#btn-eliminar"),IdScript=document.querySelector("#test-id"),Update=document.querySelector(".updateSpendig"),ModalAdd=document.querySelector(".add"),CloseModal=document.querySelector(".btn-close"),User=document.querySelector(".user"),Categoria=document.querySelector("#categoria");let Id,view,SpendingData=[],InfoProducto=[];function UserRol(){User&&User.remove()}function CalcPrevisto(){document.querySelectorAll("#diferenteTable").forEach(e=>{parseInt(e.textContent)<0?e.classList.add("text-danger"):e.classList.remove("text-danger")})}function menuBtnChange(){sidebar.classList.contains("open")?closeBtn.classList.replace("bx-menu","bx-menu-alt-right"):closeBtn.classList.replace("bx-menu-alt-right","bx-menu")}function ModalView(e){e.preventDefault();const t=document.querySelector("#descripcion"),o=document.querySelector("#previsto"),a=document.querySelector("#real");t.value="",o.value="",a.value=""}async function GetSpending(){const e=await fetch("http://localhost:3000/Dashboard/getGasto",{method:"GET"});return await e.json()}function ClassUpdate(e){e.preventDefault(),Modal.classList.contains("update")&&Modal.classList.remove("update")}function getId(e){e.preventDefault(),Modal.classList.add("update");let t="";switch(e.target.nodeName){case"path":t=e.target.parentElement.parentElement.id;break;case"svg":t=e.target.parentElement.id;break;default:t=e.target.id}document.querySelector("#idgasto").value=t;let o=SpendingData.find(e=>e.id===t);console.log(o),AddValues(o)}function AddValues(e){document.querySelector("#descripcion").value=e.descripcion_gasto,document.querySelector("#previsto").value=e.previsto_gasto,document.querySelector("#real").value=e.real_gasto||""}async function addSpending(e){try{if(e.preventDefault(),Modal.classList.contains("update"))updateSpendig();else{ValidarModal();const e=new FormData(Modal),t="http://localhost:3000/Dashboard/modal",o=await fetch(t,{method:"POST",body:e});(await o.json()).resultado&&Swal.fire({icon:"success",title:"Gasto agregado",text:"Tu gasto fue agregado correctamente",button:"OK"}).then(()=>{setTimeout(()=>{window.location.href="http://localhost:3000/Dashboard/dashboard?View=8&id="+Id},1e3)})}}catch(e){Swal.fire({icon:"error",title:"Error",text:"Hubo un error al guardar tu gasto"})}}async function updateSpendig(){try{const e=document.querySelector("#idgasto").value,t="http://localhost:3000/Dashboard/editar-gasto",o=new FormData;o.append("id",e),o.append("descripcion_previsto",document.querySelector("#descripcion").value),o.append("previsto_gasto",document.querySelector("#previsto").value),o.append("real_gasto",document.querySelector("#real").value);const a=await fetch(t,{method:"POST",body:o});(await a.json()).resultado&&(Swal.fire({icon:"success",title:"Gasto Actualizado",text:"Tu gasto fue actualizado correctamente",button:"OK"}).then(()=>{window.location.href="http://localhost:3000/Dashboard/dashboard?View=8&id="+Id}),Modal.classList.remove("update"))}catch(e){console.log(e)}}async function deleteSpen(e){try{e.preventDefault();const t=document.querySelector("#eliminar-gasto").value,o=new FormData;o.append("id",t);const a="http://localhost:3000/Dashboard/eliminar-gasto",n=await fetch(a,{method:"POST",body:o});(await n.json()).guardado&&Swal.fire({icon:"success",title:"Gasto Eliminado",text:"Tu gasto fue eliminado correctamente",button:"OK"}).then(()=>{window.location.reload()})}catch(e){Swal.fire({icon:"error",title:"Error",text:"Hubo un error al guardar tu gasto"})}}function ValidarModal(){const e=document.querySelector("#descripcion").value,t=document.querySelector("#previsto").value;""!==e&&""!==t||ImprimirAlerta("Descripción y/o Gasto previsto Obligatorio")}function ImprimirAlerta(e){const t=document.querySelector(".errores-modal");t.classList.contains("error-alerta")||(t.textContent=e,t.classList.add("error-alerta")),setTimeout(()=>{t.classList.remove("error-alerta"),t.textContent=""},5e3)}async function ObtenerCategoria(){try{const e="http://localhost:3000/Dashboard/venta",t=await fetch(e,{method:"GET"}),o=await t.json();for(let e=0;e<o.resultado.length;e++){const{id:t,nombre_categoria:a}=o.resultado[e];MostrarCategoria(t,a)}}catch(e){console.log(e)}}function MostrarCategoria(e,t){const o=document.createElement("OPTION");o.value=e,o.textContent=t,Categoria.appendChild(o)}async function categoriaSeleccionada(e){e.preventDefault();let t=e.target.selectedIndex;e.target.options[t].text;await ProductoSeleccionado().then(e=>{InfoProducto.push(...e.resultado)}).catch(e=>{console.log(e)}),MostrarProductos(InfoProducto.filter(e=>parseInt(e.cvecategoria_producto)===t))}async function ProductoSeleccionado(){const e=await fetch("http://localhost:3000/Dashboard/producto",{method:"GET"});return await e.json()}function MostrarProductos(e){const t=document.querySelector("#producto");e.forEach(e=>{const{id:o,nombre_producto:a}=e,n=document.createElement("OPTION");n.value=o,n.textContent=a,t.appendChild(n)})}function Alert(e){e.preventDefault();Swal.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1}).fire({title:"¿Estas seguro de cerrar sesión?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, seguro!",cancelButtonText:"No, cancelar!",reverseButtons:!0}).then(e=>{e.isConfirmed?window.location.href="/logout":e.dismiss===Swal.DismissReason.cancel&&Swal.close()})}document.addEventListener("DOMContentLoaded",async()=>{try{UserRol();const e=new URLSearchParams(window.location.search);Id=parseInt(e.get("id"));const t=new URLSearchParams(window.location.search);view=parseInt(t.get("View")),closeBtn.addEventListener("click",()=>{sidebar.classList.toggle("open"),menuBtnChange()}),await GetSpending().then(e=>{SpendingData.push(...e.resultado)}).catch(e=>{console.log(e)}),8===view&&(ModalAdd.addEventListener("click",ModalView),Modal.addEventListener("submit",addSpending),BtnUpdateSpending.forEach(e=>{e.addEventListener("click",getId)}),DeleteSpending.forEach(e=>{e.addEventListener("submit",deleteSpen)}),CloseModal.addEventListener("click",ClassUpdate),CalcPrevisto()),Logout.addEventListener("click",Alert),9===view&&(ObtenerCategoria(),Categoria.addEventListener("change",categoriaSeleccionada))}catch(e){console.log(e)}});
//# sourceMappingURL=bundle.js.map
